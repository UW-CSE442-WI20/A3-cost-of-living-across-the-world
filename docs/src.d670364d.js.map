{"version":3,"sources":["index.js"],"names":["updateMap","svg","d3","select","selectAll","remove","width","attr","height","projection","geoMercator","center","scale","translate","queue","defer","json","csv","await","ready","error","dataGeo","data","valueExtent","extent","d","scaleCircles","colorScale","scaleSequential","domain","interpolator","scaleOrdinal","schemeOrRd","Tooltip","append","style","g","zoom","event","transform","circle","features","enter","geoPath","call","scaleExtent","on","Longitude","Latitude","html","City","Country","linearGradient","text","subs","document","querySelectorAll","filteredTotal","i","length","checked","parentNode","getElementsByTagName","innerHTML","toFixed","checkUpperCategories","cats","total","getElementById","window","addEventListener","init","categories","subCategories","onclick","forEach","category","subCategory","catSubCategories","id","catSubCategory","classList","subCategoriesCat","count","subCategoriesCount"],"mappings":"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","file":"src.d670364d.js","sourceRoot":"../src","sourcesContent":["\"use strict\";\n(function() {\n  window.addEventListener(\"load\", init);\n\n  function init() {\n    updateMap();\n    const categories = document.querySelectorAll('.category');\n    const subCategories = document.querySelectorAll('.subcategory');\n\n    // Set Total Onclick Listener\n    document.getElementById('total').onclick = function() {\n      categories.forEach(category => {\n        category.checked = this.checked;\n      })\n\n      subCategories.forEach(subCategory => {\n        subCategory.checked = this.checked;\n        checkUpperCategories();\n      })\n      updateMap();\n    }\n\n    // Set Categories Onclick Listener\n    categories.forEach(category => {\n      category.onclick = function () {\n        const catSubCategories = document.querySelectorAll('.' + this.id);\n        catSubCategories.forEach(catSubCategory => {\n          catSubCategory.checked = this.checked;\n      })\n        checkUpperCategories();\n        updateMap();\n      }\n    })\n\n    // Set SubCategories Onclick Listener\n    subCategories.forEach(subCategory => {\n      subCategory.onclick = function () {\n        const category = subCategory.classList[0];\n        const subCategoriesCat = document.getElementById(category);\n        const count = document.querySelectorAll('.' + category + ':checked').length;\n        const subCategoriesCount = document.querySelectorAll('.' + category).length;\n\n        subCategoriesCat.checked = (count === subCategoriesCount);\n        checkUpperCategories();\n        updateMap();\n      }\n    })\n  }\n\n  function updateMap() {\n\n    // The svg\n    var svg = d3.select(\"svg\");\n    svg.selectAll(\"*\").remove();\n    \n    var width = +svg.attr(\"width\"),\n    height = +svg.attr(\"height\");\n\n    // Map and projection\n    var projection = d3.geoMercator()\n    .center([0,20])                // GPS of location to zoom on\n    .scale(99)                       // This is like the zoom\n    .translate([ width/2, height/2 ])\n\n    d3.queue()\n    .defer(d3.json, \"https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson\")  // World shape\n    .defer(d3.csv, \"https://gist.githubusercontent.com/mtgemo/407034207687ace3529864158ea46856/raw/1b6c0ffa28890dc514b917344e27eb6e128e8ac0/usd-total-CoL.csv\") // Position of circles\n    .await(ready);\n\n    function ready(error, dataGeo, data) {\n\n      // Add a scale for bubble size\n      var valueExtent = d3.extent(data, function(d) {return +scaleCircles(d); })\n\n      var colorScale = d3.scaleSequential()\n        .domain(valueExtent)\n        .interpolator(d3.scaleOrdinal(d3.schemeOrRd[5]));\n\n      var Tooltip = svg\n          .append(\"text\")\n          .attr(\"text-anchor\", \"end\")\n          .style(\"fill\", \"black\")\n          .attr(\"x\", width - 10)\n          .attr(\"y\", height - 30)\n          .attr(\"width\", 90)\n          .style(\"font-size\", 14)\n\n\n  // Three function that change the tooltip when user hover / move / leave a cell\n  // Will make the tooltip visible once a user hovers over an object that contains information to show\n  var mouseover = function (d) {\n      Tooltip.style(\"opacity\", 1)\n  }\n\n  // This adds the data to the tooltip that will be displayed to the user\n  var mousemove = function (d) {\n      Tooltip\n          .html(d.City + \", \" + d.Country + \" - Total Cost of Living: $\" + scaleCircles(d) + \"\")\n  }\n\n  // Will make the tooltip invisible once the users mouse moves off of an object that contains information\n  var mouseleave = function (d) {\n      Tooltip.style(\"opacity\", 0)\n  }\n\n      var g = svg.append(\"g\");\n\n      // Draw the map\n      g.selectAll(\"path\")\n      .data(dataGeo.features)\n      .enter()\n      .append(\"path\")\n      .attr(\"transform\", function(d) { return \"translate(\" + d + \")\"; }) // zooming effect\n      .attr(\"fill\", \"#b8b8b8\")\n      .attr(\"d\", d3.geoPath()\n          .projection(projection)\n      )\n      .style(\"stroke\", \"none\")\n      .style(\"opacity\", .3)\n\n      // Make the map zoomable\n    svg.append(\"rect\")\n    .attr(\"fill\", \"none\")\n    .attr(\"pointer-events\", \"all\")\n    .attr(\"width\", width)\n    .attr(\"height\", height)\n    .call(d3.zoom()\n        .scaleExtent([1, 8])\n        .on(\"zoom\", zoom));\n\n    function zoom() {\n      g.attr(\"transform\", d3.event.transform);\n      circle.attr(\"transform\", d3.event.transform);\n    }\n\n\n    if (valueExtent[0] !== 0 && valueExtent[1] !== 0) {\n\n      // Add circles\n      var circle = svg.selectAll(\"circle\")\n          .data(data)\n          .enter().append(\"circle\")\n              .attr(\"r\", 3) // radius\n              .attr(\"cx\", function(d){ return projection([+d.Longitude, +d.Latitude])[0] }) // coordinates\n              .attr(\"cy\", function(d){ return projection([+d.Longitude, +d.Latitude])[1] })\n              .style(\"fill\", function(d){ return colorScale(scaleCircles(d))}) // scale value to color\n              .attr(\"fill-opacity\", .7)\n              .attr(\"stroke\", \"black\")\n              .attr(\"stroke-width\", 0.2)\n              .on(\"mouseover\", mouseover) // These three functions are what makes our tooltip appear, display our data,\n              .on(\"mousemove\", mousemove) // and make the tooltip disappear in the end\n              .on(\"mouseleave\", mouseleave)\n              .call(d3.zoom()\n                  .on(\"zoom\", zoom))\n\n\n              var margin = 0,\n              widthTwo = 250 - margin,\n              heightTwo = 20 - margin;\n    \n              var linearGradient = svg.append(\"defs\")\n                  .append(\"linearGradient\")\n                  .attr(\"id\", \"linear-gradient\");\n    \n              linearGradient.append(\"stop\")\n                  .attr(\"offset\", \"0%\")\n                  .attr(\"stop-color\", colorScale(10000));\n    \n              linearGradient.append(\"stop\")\n                  .attr(\"offset\", \"25%\")\n                  .attr(\"stop-color\", colorScale(20000));\n    \n              linearGradient.append(\"stop\")\n                  .attr(\"offset\", \"50%\")\n                  .attr(\"stop-color\", colorScale(30000));\n    \n              linearGradient.append(\"stop\")\n                  .attr(\"offset\", \"75%\")\n                  .attr(\"stop-color\", colorScale(40000));\n    \n              linearGradient.append(\"stop\")\n                  .attr(\"offset\", \"100%\")\n                  .attr(\"stop-color\", colorScale(50000));\n    \n              svg.append(\"rect\")\n                  .attr(\"x\", width - widthTwo - 50)\n                  .attr(\"y\", 50)\n                  .attr(\"width\", widthTwo)\n                  .attr(\"height\", heightTwo)\n                  .style(\"fill\", \"url(#linear-gradient)\");\n              svg.append(\"text\")\n                    .attr(\"class\", \"caption\")\n                    .attr(\"x\", width - widthTwo - 50)\n                    .attr(\"y\", 40)\n                    .attr(\"fill\", \"#000\")\n                    .attr(\"font-size\", 14)\n                    .attr(\"text-anchor\", \"start\")\n                    .text(\"Total Cost (USD)\");\n              svg.append(\"text\")\n                  .attr(\"class\", \"caption\")\n                  .attr(\"x\", width - widthTwo - 50)\n                  .attr(\"y\", 90)\n                  .attr(\"fill\", \"#000\")\n                  .attr(\"font-size\", 14)\n                  .attr(\"text-anchor\", \"start\")\n                  .text(valueExtent[0]);\n              svg.append(\"text\")\n                .attr(\"class\", \"caption\")\n                .attr(\"x\", width - 75)\n                .attr(\"y\", 90)\n                .attr(\"fill\", \"#000\")\n                .attr(\"font-size\", 14)\n                .attr(\"text-anchor\", \"start\")\n                .text(valueExtent[1]);\n    }\n  \n    }\n  }\n\n  function scaleCircles(d) {\n    var subs = document.querySelectorAll('.subcategory');\n    var filteredTotal = 0;\n    for (var i = 0; i < subs.length; i++) {\n      if (subs[i].checked) {\n        filteredTotal += (+d[subs[i].parentNode.getElementsByTagName('span')[0].innerHTML]);\n      }\n    }\n    return filteredTotal.toFixed(2);\n  }\n\n  function checkUpperCategories() {\n    const cats = document.querySelectorAll('.category:checked');\n    const total = document.getElementById('total');\n    if (cats.length === 5) {\n      total.checked = true;\n    } else {\n      total.checked = false;\n    }\n  }\n})();"]}